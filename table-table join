CREATE TABLE JOINED_TABLE WITH (KAFKA_TOPIC='joined_table', value_format = 'JSON') AS SELECT
  COALESCE(C.CUSTOMER_ID, T.CUSTOMER_ID) CUSTOMER_ID,
  C.NAME NAME,
  C.GENDER GENDER,
  C.SALARY SALARY,
  T.MONTH MONTH,
  T.CATEGORY CATEGORY,
  T.PAYMENT_TYPE PAYMENT_TYPE,
  T.SPEND SPEND,
  T.TRANSACTION_ID TRANSACTION_ID,
  ROWKEY JOIN_KEY
FROM CUSTOMER_TABLE C
FULL OUTER JOIN TRANSACTION_TABLE T ON ((C.CUSTOMER_ID = T.CUSTOMER_ID))
EMIT CHANGES;
